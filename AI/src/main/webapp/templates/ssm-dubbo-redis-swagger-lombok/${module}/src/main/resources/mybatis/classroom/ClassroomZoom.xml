<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<!-- 不使用namespace的话sql搜索定位会比较方便 -->
<mapper namespace="ClassroomZoom">

    <resultMap id="rs_base" type="ClassroomZoom">
        <result property="id" column="id"/>
        <result property="zoomCode" column="zoomCode"/>
        <result property="uuid" column="uuid"/>
        <result property="zoomId" column="zoomId"/>
        <result property="zoomRealId" column="zoomRealId"/>
        <result property="classroomCode" column="classroomCode"/>
        <result property="joinUrl" column="joinUrl"/>
        <result property="startUrl" column="startUrl"/>
        <result property="timezone" column="timezone"/>
        <result property="password" column="password"/>
        <result property="topic" column="topic"/>
        <result property="startTime" column="startTime"/>
        <result property="createTime" column="createTime"/>
    </resultMap>


    <!--所有信息-->
    <resultMap id="rs_base_all" type="ClassroomZoom" extends="rs_base">
        <association property="zoom" column="{zoomCode=zoomCode}" select="Zoom.loadBy"/>
    </resultMap>

    <!-- 用于select查询公用抽取的列 -->
    <sql id="ClassroomZoom.columns">
		id,zoomCode,uuid,zoomId,zoomRealId,classroomCode,joinUrl,startUrl,timezone,password,topic,startTime,createTime
	</sql>


    <insert id="ClassroomZoom.insert" useGeneratedKeys="true" keyProperty="id" parameterType="ClassroomZoom">
        INSERT INTO classroom_zoom (
        id ,
        zoomCode ,
        uuid ,
        zoomId ,
        zoomRealId ,
        classroomCode ,
        joinUrl ,
        startUrl ,
        timezone ,
        password ,
        topic ,
        startTime ,
        createTime
        ) VALUES (
        #{id} ,
        #{zoomCode} ,
        #{uuid} ,
        #{zoomId} ,
        #{zoomRealId} ,
        #{classroomCode} ,
        #{joinUrl} ,
        #{startUrl} ,
        #{timezone} ,
        #{password} ,
        #{topic} ,
        #{startTime} ,
        #{createTime}
        )
        <selectKey keyProperty="id" resultType="long">
            select LAST_INSERT_ID()
        </selectKey>
    </insert>

    <update id="ClassroomZoom.update" parameterType="ClassroomZoom">

        UPDATE classroom_zoom

        <trim prefix="set" suffixOverrides=",">
            <if test="zoomCode!=null and zoomCode!=''">
                zoomCode = #{zoomCode} ,
            </if>
            <if test="uuid!=null and uuid!=''">
                uuid = #{uuid} ,
            </if>
            <if test="zoomId!=null and zoomId!=''">
                zoomId = #{zoomId} ,
            </if>
            <if test="zoomRealId!=null and zoomRealId!=''">
                zoomRealId = #{zoomRealId} ,
            </if>
            <if test="classroomCode!=null and classroomCode!=''">
                classroomCode = #{classroomCode} ,
            </if>
            <if test="joinUrl!=null and joinUrl!=''">
                joinUrl = #{joinUrl} ,
            </if>
            <if test="startUrl!=null and startUrl!=''">
                startUrl = #{startUrl} ,
            </if>
            <if test="timezone!=null and timezone!=''">
                timezone = #{timezone} ,
            </if>
            <if test="password!=null and password!=''">
                password = #{password} ,
            </if>
            <if test="topic!=null and topic!=''">
                topic = #{topic} ,
            </if>
            <if test="startTime!=null and startTime!=''">
                startTime = #{startTime} ,
            </if>
            <if test="createTime!=null ">
                createTime = #{createTime}
            </if>
        </trim>

        WHERE
        id = #{id}
    </update>

    <delete id="ClassroomZoom.delete">

        DELETE FROM classroom_zoom WHERE
        id = #{id} 

    </delete>

    <select id="ClassroomZoom.load" resultMap="rs_base_all">
        SELECT
        <include refid="ClassroomZoom.columns"/>
        FROM classroom_zoom
        <include refid="ClassroomZoom.where"/>
    </select>

    <sql id="ClassroomZoom.where">
        <where>
            <if test="id!=null and id!=''">
                AND id = #{id}
            </if>
            <if test="zoomCode!=null and zoomCode!=''">
                AND zoomCode = #{zoomCode}
            </if>
            <if test="uuid!=null and uuid!=''">
                AND uuid = #{uuid}
            </if>
            <if test="zoomId!=null and zoomId!=''">
                AND zoomId = #{zoomId}
            </if>
            <if test="zoomRealId!=null and zoomRealId!=''">
                AND zoomRealId = #{zoomRealId}
            </if>
            <if test="classroomCode!=null and classroomCode!=''">
                AND classroomCode = #{classroomCode}
            </if>
            <if test="joinUrl!=null and joinUrl!=''">
                AND joinUrl = #{joinUrl}
            </if>
            <if test="startUrl!=null and startUrl!=''">
                AND startUrl = #{startUrl}
            </if>
            <if test="timezone!=null and timezone!=''">
                AND timezone = #{timezone}
            </if>
            <if test="password!=null and password!=''">
                AND password = #{password}
            </if>
            <if test="topic!=null and topic!=''">
                AND topic = #{topic}
            </if>
            <if test="startTimeBegin!=null ">
                AND startTime >= #{startTimeBegin}
            </if>
            <if test="startTimeEnd!=null ">
                AND startTime &lt;= #{startTimeEnd}
            </if>
            <if test="createTimeBegin!=null ">
                AND createTime >= #{createTimeBegin}
            </if>
            <if test="createTimeEnd!=null ">
                AND createTime &lt;= #{createTimeEnd}
            </if>
        </where>
    </sql>


    <select id="ClassroomZoom.count" resultType="long">
        SELECT count(1) FROM classroom_zoom
        <include refid="ClassroomZoom.where"/>
    </select>


    <select id="ClassroomZoom.query" resultMap="rs_base">
        SELECT
        <include refid="ClassroomZoom.columns"/>
        FROM classroom_zoom
        <include refid="ClassroomZoom.where"/>

        <if test="sortColumns!=null and sortColumns!=''">
            ORDER BY ${sortColumns}
        </if>
    </select>


</mapper>

