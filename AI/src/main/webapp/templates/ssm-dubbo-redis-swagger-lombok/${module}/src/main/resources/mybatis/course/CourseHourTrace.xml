<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<!-- 不使用namespace的话sql搜索定位会比较方便 -->
<mapper namespace="CourseHourTrace">

    <resultMap id="rs_base" type="CourseHourTrace">
        <result property="id" column="id"/>
        <result property="courseHourTraceCode" column="courseHourTraceCode"/>
        <result property="studentCode" column="studentCode"/>
        <result property="totalBeforeChange" column="totalBeforeChange"/>
        <result property="courseHour" column="courseHour"/>
        <result property="totalAfterChange" column="totalAfterChange"/>
        <result property="changeType" column="changeType"/>
        <result property="event" column="event"/>
        <result property="courseHourType" column="courseHourType"/>
        <result property="summary" column="summary"/>
        <result property="optCode" column="optCode"/>
        <result property="optName" column="optName"/>
        <result property="createTime" column="createTime"/>
    </resultMap>

    <!-- 用于select查询公用抽取的列 -->
    <sql id="CourseHourTrace.columns">
		id,courseHourTraceCode,studentCode,totalBeforeChange,courseHour,totalAfterChange,changeType,event,courseHourType,summary,optCode,optName,createTime
	</sql>

    <insert id="CourseHourTrace.insert" useGeneratedKeys="true" keyProperty="id" parameterType="CourseHourTrace">
        INSERT INTO `course_hour_trace` (
        id ,
        courseHourTraceCode ,
        studentCode ,
        totalBeforeChange ,
        courseHour ,
        totalAfterChange ,
        changeType ,
        event ,
        courseHourType ,
        summary ,
        optCode ,
        optName ,
        createTime
        ) VALUES (
        #{id} ,
        #{courseHourTraceCode} ,
        #{studentCode} ,
        #{totalBeforeChange} ,
        #{courseHour} ,
        #{totalAfterChange} ,
        #{changeType} ,
        #{event} ,
        #{courseHourType} ,
        #{summary} ,
        #{optCode} ,
        #{optName} ,
        #{createTime}
        )
        <selectKey keyProperty="id" resultType="long">
            select LAST_INSERT_ID()
        </selectKey>
    </insert>

    <update id="CourseHourTrace.update" parameterType="CourseHourTrace">
        UPDATE `course_hour_trace`

        <trim prefix="set" suffixOverrides=",">
            <if test="courseHourTraceCode!=null and courseHourTraceCode!=''">
                courseHourTraceCode = #{courseHourTraceCode} ,
            </if>
            <if test="studentCode!=null and studentCode!=''">
                studentCode = #{studentCode} ,
            </if>
            <if test="totalBeforeChange!=null and totalBeforeChange!=''">
                totalBeforeChange = #{totalBeforeChange} ,
            </if>
            <if test="courseHour!=null ">
                courseHour = #{courseHour} ,
            </if>
            <if test="totalAfterChange!=null and totalAfterChange!=''">
                totalAfterChange = #{totalAfterChange} ,
            </if>
            <if test="changeType!=null and changeType!=''">
                changeType = #{changeType} ,
            </if>
            <if test="event!=null and event!=''">
                event = #{event} ,
            </if>
            <if test="courseHourType!=null and courseHourType!=''">
                courseHourType = #{courseHourType} ,
            </if>
            <if test="summary!=null and summary!=''">
                summary = #{summary} ,
            </if>
            <if test="optCode!=null and optCode!=''">
                optCode = #{optCode} ,
            </if>
            <if test="optName!=null and optName!=''">
                optName = #{optName} ,
            </if>
            <if test="createTime!=null ">
                createTime = #{createTime}
            </if>
        </trim>

        WHERE
        id = #{id}
    </update>

    <delete id="CourseHourTrace.delete">
        DELETE FROM course_hour_trace WHERE
        id = #{id} 
    </delete>

    <select id="CourseHourTrace.load" resultMap="rs_base">
        SELECT
        <include refid="CourseHourTrace.columns"/>
        FROM course_hour_trace
        <include refid="CourseHourTrace.where"/>

    </select>

    <sql id="CourseHourTrace.where">
        <where>
            <if test="id!=null and id!=''">
                AND id = #{id}
            </if>
            <if test="courseHourTraceCode!=null and courseHourTraceCode!=''">
                AND courseHourTraceCode = #{courseHourTraceCode}
            </if>
            <if test="studentCode!=null and studentCode!=''">
                AND studentCode = #{studentCode}
            </if>
            <if test="totalBeforeChange!=null and totalBeforeChange!=''">
                AND totalBeforeChange = #{totalBeforeChange}
            </if>
            <if test="courseHour!=null ">
                AND courseHour = #{courseHour}
            </if>
            <if test="totalAfterChange!=null and totalAfterChange!=''">
                AND totalAfterChange = #{totalAfterChange}
            </if>
            <if test="changeType!=null and changeType!=''">
                AND changeType = #{changeType}
            </if>
            <if test="event!=null and event!=''">
                AND event = #{event}
            </if>
            <if test="courseHourType!=null and courseHourType!=''">
                AND courseHourType = #{courseHourType}
            </if>
            <if test="summary!=null and summary!=''">
                AND summary = #{summary}
            </if>
            <if test="optCode!=null and optCode!=''">
                AND optCode = #{optCode}
            </if>
            <if test="optName!=null and optName!=''">
                AND optName = #{optName}
            </if>
            <if test="createTimeBegin!=null">
                AND createTime >= #{createTimeBegin}
            </if>
            <if test="createTimeEnd!=null">
                AND createTime &lt;= #{createTimeEnd}
            </if>
        </where>
    </sql>


    <select id="CourseHourTrace.count" resultType="int">
        SELECT count(1) FROM course_hour_trace
        <include refid="CourseHourTrace.where"/>
    </select>


    <select id="CourseHourTrace.query" resultMap="rs_base">
        SELECT
        <include refid="CourseHourTrace.columns"/>
        FROM course_hour_trace
        <include refid="CourseHourTrace.where"/>
        ORDER BY courseHourTraceCode DESC
    </select>
</mapper>

